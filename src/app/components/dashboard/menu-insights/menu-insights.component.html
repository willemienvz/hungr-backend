@if (layoutMinimised) {
<div class="inner-page">
    <app-loading [isLoading]="isLoading"></app-loading>
    
    <!-- Compact Date Range Selection (Minimized) -->
    <div class="date-range-compact">
        <div class="date-range-controls">
            <div class="date-field">
                <app-form-input
                    type="date"
                    label="From:"
                    placeholder="From date"
                    [(ngModel)]="dateFrom"
                    (ngModelChange)="onDateRangeChange()">
                </app-form-input>
            </div>

            <div class="date-field">
                <app-form-input
                    type="date"
                    label="To:"
                    placeholder="To date"
                    [(ngModel)]="dateTo"
                    (ngModelChange)="onDateRangeChange()">
                </app-form-input>
            </div>

            <button class="hungr-btn hungr-btn-primary" (click)="applyDateRange()">
                Apply
            </button>
        </div>
    </div>
    
    <div class="stats-grid">
        <app-stats-insight-card 
            title="Total Menu Views" 
            [subtitle]="getDateRangeText()"
            [value]="viewingTotalCurrentWeek.toString()"
            [trend]="getWeeklyDifferenceMessage()"
            [trendDirection]="viewingTotalCurrentWeek >= viewingTotalPreviousWeek ? 'up' : 'down'"
            type="numeric"
            tooltipText="Total number of menu views in the selected date range"
        ></app-stats-insight-card>
        
        <app-stats-insight-card 
            title="New views" 
            [subtitle]="getDateRangeText()"
            [value]="viewingTotalLast24Hours.toString()"
            [trend]="getDailyDifferenceMessage()"
            [trendDirection]="viewingTotalLast24Hours >= viewingTotalPrevious24Hours ? 'up' : 'down'"
            type="numeric"
            tooltipText="New views in the selected date range"
        ></app-stats-insight-card>

        <app-stats-insight-card 
            title="Most Viewed Category" 
            [subtitle]="getDateRangeText()"
            [value]="mostOrderedCategory || 'No data'"
            type="text-block"
            variant="primary"
            tooltipText="The most viewed category in the selected date range"
        ></app-stats-insight-card>
    </div>
    <div class="row">
        <app-content-block title="Daily Menu Visits">
            <div echarts [options]="chartOptions" class="echart"></div>
        </app-content-block>
    </div>
</div>
}@else {

<div class="inner-page">
    <app-loading [isLoading]="isLoading"></app-loading>

    <!-- Compact Date Range Selection -->
    <div class="date-range-compact">
        <div class="date-range-controls">
            <div class="date-field">
                <app-form-input
                    type="date"
                    label="From:"
                    placeholder="From date"
                    [(ngModel)]="dateFrom"
                    (ngModelChange)="onDateRangeChange()">
                </app-form-input>
            </div>

            <div class="date-field">
                <app-form-input
                    type="date"
                    label="To:"
                    placeholder="To date"
                    [(ngModel)]="dateTo"
                    (ngModelChange)="onDateRangeChange()">
                </app-form-input>
            </div>

            <button class="hungr-btn hungr-btn-primary" (click)="applyDateRange()">
                Apply
            </button>
        </div>
    </div>
    
    <div class="stats-grid">
        <app-stats-insight-card 
            title="Total Menu Views" 
            [subtitle]="getDateRangeText()"
            [value]="viewingTotalCurrentWeek.toString()"
            [trend]="getWeeklyDifferenceMessage()"
            [trendDirection]="viewingTotalCurrentWeek >= viewingTotalPreviousWeek ? 'up' : 'down'"
            type="numeric"
            tooltipText="Total number of menu views in the selected date range"
        ></app-stats-insight-card>
        
        <app-stats-insight-card 
            title="New views" 
            [subtitle]="getDateRangeText()"
            [value]="viewingTotalLast24Hours.toString()"
            [trend]="getDailyDifferenceMessage()"
            [trendDirection]="viewingTotalLast24Hours >= viewingTotalPrevious24Hours ? 'up' : 'down'"
            type="numeric"
            tooltipText="New views in the selected date range"
        ></app-stats-insight-card>

        <app-stats-insight-card 
            title="Most Viewed Category" 
            [subtitle]="getDateRangeText()"
            [value]="mostOrderedCategory || 'No data'"
            type="text-block"
            variant="primary"
            tooltipText="The most viewed category in the selected date range"
        ></app-stats-insight-card>

        <app-stats-insight-card 
            title="Most Ordered Item" 
            [subtitle]="getDateRangeText()"
            [value]="topOrderedItems[0]?.name || 'No data'"
            type="text-block"
            variant="secondary"
            tooltipText="The most ordered item in the selected date range"
        ></app-stats-insight-card>
    </div>
    <div class="row" *ngIf="!isLoading">
        <app-content-block title="Daily Menu Visits" customClass="biggerBlock">
            <div echarts [options]="chartOptions" class="echart"></div>
        </app-content-block>
        <app-content-block title="Sales Overview">
            <div echarts [options]="chartOptionsCategoryPercentages" class="echart"></div>
        </app-content-block>
    </div>
    <div class="row">
        <app-content-block title="Most Ordered Items">
            <div echarts [options]="chartOptionsMostOrderedItems" class="echart"></div>
        </app-content-block>
        <app-content-block title="Frequent Item Pairs">
            <div class="pariholder">
                <div *ngFor="let pair of frequentItemPairs" class="pair-item">
                    <span class="pair-text">{{ pair.itemA }} + {{ pair.itemB }}</span>
                    <span class="pair-count">{{ pair.count }} orders</span>
                </div>
            </div>
        </app-content-block>
    </div>
</div>
}